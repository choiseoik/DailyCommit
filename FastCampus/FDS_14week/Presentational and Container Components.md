# Presentational and Container Components

React 어플리케이션을 작성할 때 아주 유용하게 사용될수 있는 패턴이 있다.

재사용성과 유지 보수성을 높이기 위해서 컴포넌트를 두가지 종류에 나누어 생각할 수 있다.

Container 와 Presentational 컴포넌트로 나눌 수 있다.

## Presentational 은 아래와같은 성질을 갖는다.

- 어떻게 보여질지를 책임진다.
- 내부에 presentational 컴포넌트와 container 컴포넌트 모두를 가질 수 있고, 대개 DOM 마크업과 자체 스타일을 가진다.
- this.props.children 을 통해 다른 컴포넌트를 포함하게끔 만들 수 있다.
- 어플리케이션의 나머지 부분에 대해 아무런 의존성을 가지지 않는다. (예를 들면 Flux 액션이나 store 등)
- 데이터 및 데이터와 관련된 콜백은 props 를 통해서 받기만 한다.
- (데이터가 아닌) UI 상태를 관리하기 위해 state 를 갖는 경우가 있다.
- state, Lifecycle, 성능 최적화가 필요없는 경우라면 함수형 컴포넌트로 작성된다.
- 예시 : Page, sidebar, Story, UserInfo, List

## Container Component 는 다음과 같은 성질을 갖는다

- 어떻게 동작해야 될지를 책임진다.
- 내부에 presentational 컴포넌트와 container 컴포넌트 모두를 가질 수 있지만, 대개(전체를 감싸는 div 를 제외하면) 자체적인 DOM 마크업이나 스타일을 가지고 있지 않다.
- 데이터 및 데이터와 관련된 동작을 다른 presentatinoal 컴포넌트와 container 컴포넌트에게 제공한다.
- 주로 데이터 저장소로 활용되며 state 를 갖고 있는 경우가 많다.
- 직접 작성되기 보다는 higher order components 로 부터 생성되는 경우가 많다. (React Redux 의 connect(), Relay 의 CreateContainer(), Flux Utils 의 Container.create())
- 예시 : UserPage, Followersidebar, storyContainer, FollowedUserList

이 둘 사이의 구분을 명확히 하기위해 서로 다른 폴더에 집어 넣는 것을 추천한다.

## 이러한 접근 방식의 이점

- 관심사의 분리를 더 잘할 수 있다. 이 방식으로 컴포넌트를 작성하면 당신의 앱과 UI 를 이해하기 쉽게 만들 수 잇따.
- 재사용성을 높일 수 있다. 완전히 다른 곳으로부터 온 여러 상태라 할지라도, 이를 표현하기 위해 같은 presentational 컴포넌트를 사용할 수 있다. 이때 각 상태를 나타내는 container 컴포넌트를 만들어 이를 또 재사용 할 수 있다.
- presentational 컴포넌트는 말하자면 앱의 "팔레트" 역할을 한다. 이 컴포넌트들은 데모 페이지에 넣어두고, 디자이너에게 디자인 세부사항을 수정하는 작업을 맡길 수 있다. 디자이너는 앱의 로직을 건드릴 필요가 없다. 또한 데모페이지에 대해 스크린샷 회귀 테스트를 수행할 수도 있다.
- 이 패턴을 제대로 적용하려면 "레이아웃 컴포넌트"를 추출해야한다. 레이아웃 컴포넌트를 추출하면, 똑같은 레이아웃 마크업을 여러 container 컴포넌트에 작성하는 작업을 피할 수 있다.

### **컴포넌트가 DOM 을 출력하지 않아도 괜찮다.** 오직 여러 UI 요소들을 어떻게 합성할지에 대해서만 책임을 질 뿐이다.

## container 컴포넌트를 작성해야될 시기

앱을 제작할 때, 먼저 presentational 컴포넌트부터 작성해 보자. 결국 아주 많은 prop 들을 중간 계층의 컴포넌트에 전달해야 한다는 사실을 깨닫게 될 것이다. 그 중 어떤 컴포넌트가 props 를 그저 아래로 내려보내주고 있어서, 자식 컴포넌트가 더 많은 데이터를 필요로 할 때 중간 계층에서 일일이 이어주어야 한다면, 그때가 바로 container 컴포넌트를 적용하기 좋은 시점이다. 이 방법을 통해 별도 상관도 없는 중간 계층의 컴포넌트에 부담을 지우지 않고도 맨 아래에 있는 컴포넌트에 데이터를 내려줄 수 있다.
이러한 리팩토링 절차는 계속 진행될 것이고, 처음부터 모든 부분을 정확하게 작성하려고 할 필요가 없다. 이 패턴을 적용하다 보면, 언제 container 컴포넌트를 추출해야 할지에 대한 감을 잡을 수 있다. 마치 언제 함수를 추출해야 할지를 알게 되는 것과 같다.

## 다른 분류법

Presentational 컴포넌트와 container 컴포넌트 간의 차이점이 기술적인 부분에서 오는 것이 아니라는 점을 이해하는 것이 중요하다. 그보다는 **어떤 목적**을 가지는지에 따라 분류해야 한다.

반면에, 비슷하면서도 다른 몇가지 기술적 분류법들이 있다.

- **상태(stateful)와 무상태(Stateless).** React 의 setState()를 쓰는 컴포넌트도 있고 그렇지 않은 컴포넌트도 있다. 대개 container 컴포넌트는 상태를 갖고 presentational 컴포넌트는 상태를 갖지 않는 경향이 있지만, 엄격하게 지켜야 하는 규칙은 아니다. Presentaional 컴포넌트가 상태를 가질 수도 있고, container 컴포넌트가 상태를 갖지 않을 수 도 있다.
- **클래스와 함수.** React 0.14 버전부터, 컴포넌트는 클래스로 선언될 수도, 함수로 선언될 수도 있다. 함수형 컴포넌트는 정의하기는 쉽지만 클래스 컴포넌트에서만 쓸 수 있는 몇몇 기능이 빠져있다. 이런 제약중 일부는 미래에 없어질 예정이지만 현재는 어쩔 수 없다. 함수형 컴포넌트는 이해하기 쉽기 때문에, sate, Lifecycle 또는 성능최적화가 필요하지 않은 경우 함수형 컴포넌트를 사용하는 것을 권장한다.
- **순수(pure)혹은 비순수(impure).** 사람들은 같은 props 와 state 가 주어졌을 때 같은 출력이 나오는 컴포넌트를 순수하다고 말한ㄷ. 순수한 컴포넌트는 클래스로 정의될 수도, 함수도 정의될 수도 있으며, 상태를 가질 수도, 가지지 않을수도 있다. 순수한 컴포넌트의 또다른 중요한 측면은 props 나 state 의 깊은 변경사항에 의존하지 않아야 한다는 점이다. 그에따라 shouldComponentUpdate() 훅 내부에서 얕은 비교만을 통해 렌더링 성능을 최적화할수 있다.

어떤 컴포넌트가 Presentational 컴포넌트인지 container 컴포넌트 인지를 명확히 결정할 수 없는 경우도 있다. presentational 컴포넌트는 무상태 순수 함수인 경향이 있고 container 는 상태를 갖는 순수 클래스인 경향이 있다. 하지만 반드시 그런 것은 아니고 특정상화에서는 정확히 반대인 경두오 있다.

Presentational 컴포넌트와 container 컴포넌트 간의 구분을 너무 명확히 하려고 하지 않는 것이 좋다. 그게 별로 중요하지 않을 떄도 있고, 또 선을 명확히 긋는 것도 어렵다. 어떤 컴포넌트가 presentational 이어야 하는지 아니면 container 여야 하는 지 어렵다면 그 결정이 이를 때이다.
